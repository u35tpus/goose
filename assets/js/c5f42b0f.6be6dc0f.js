"use strict";(globalThis.webpackChunkgoose=globalThis.webpackChunkgoose||[]).push([[9275],{5341:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>a,default:()=>d,frontMatter:()=>s,metadata:()=>r,toc:()=>c});const r=JSON.parse('{"id":"tutorials/ralph-loop","title":"Ralph Loop","description":"Run goose in a loop with fresh context per iteration and cross-model review","source":"@site/docs/tutorials/ralph-loop.md","sourceDirName":"tutorials","slug":"/tutorials/ralph-loop","permalink":"/goose/docs/tutorials/ralph-loop","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{"title":"Ralph Loop","description":"Run goose in a loop with fresh context per iteration and cross-model review"},"sidebar":"tutorialSidebar","previous":{"title":"Planning Complex Tasks","permalink":"/goose/docs/tutorials/plan-feature-devcontainer-setup"},"next":{"title":"Recipes","permalink":"/goose/docs/tutorials/recipes-tutorial"}}');var o=t(74848),i=t(28453);const s={title:"Ralph Loop",description:"Run goose in a loop with fresh context per iteration and cross-model review"},a=void 0,l={},c=[{value:"Prerequisites",id:"prerequisites",level:3},{value:"Step 1: Start the Loop",id:"step-1-start-the-loop",level:3},{value:"Step 2: Configure Models",id:"step-2-configure-models",level:3},{value:"Step 3: Watch It Run",id:"step-3-watch-it-run",level:3},{value:"How It Works",id:"how-it-works",level:2},{value:"State Files",id:"state-files",level:3},{value:"Recipe Files",id:"recipe-files",level:3},{value:"Usage Tips",id:"usage-tips",level:2},{value:"When to Use Ralph Loop",id:"when-to-use-ralph-loop",level:3},{value:"Resetting",id:"resetting",level:3}];function h(e){const n={a:"a",admonition:"admonition",code:"code",h2:"h2",h3:"h3",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...e.components},{Details:t}=n;return t||function(e,n){throw new Error("Expected "+(n?"component":"object")+" `"+e+"` to be defined: you likely forgot to import, pass, or provide it.")}("Details",!0),(0,o.jsxs)(o.Fragment,{children:[(0,o.jsxs)(n.p,{children:["Ralph Loop, based on ",(0,o.jsx)(n.a,{href:"https://ghuntley.com/ralph/",children:"Geoffrey Huntley's Ralph Wiggum technique"}),", is an iterative development pattern that keeps goose working on a task until it's genuinely complete."]}),"\n",(0,o.jsx)(n.p,{children:"Standard agent loops suffer from context accumulation. Every failed attempt stays in the conversation history, which means that after a few iterations, the model must process a long history of noise before it can focus on the task. Ralph Loop solves this by starting each iteration with fresh context, the core insight behind Geoffrey's approach. This implementation extends the technique with cross-model review: one model does the work, a different model reviews it, and the loop continues until the task is ready to ship."}),"\n",(0,o.jsx)(n.p,{children:"After each iteration, the worker and reviewer models store a summary and feedback in files. These files persist between iterations but the conversation history does not. This allows a new session to start where the next model reads the files to pick up exactly where the last iteration left off."}),"\n",(0,o.jsx)(n.p,{children:"In this tutorial, we'll use Ralph Loop to build a simple Electron-based browser and see how the iteration cycle catches missing features before shipping."}),"\n",(0,o.jsx)(n.h3,{id:"prerequisites",children:"Prerequisites"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"/docs/getting-started/installation",children:"Install the goose CLI"})," because the Ralph Loop runs via the terminal."]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.a,{href:"/docs/getting-started/providers",children:"Configure two models"})," to serve as the worker and reviewer. Using different models is recommended for higher quality reviews, though the loop still works if you use the same model for both roles."]}),"\n"]}),"\n",(0,o.jsxs)(t,{children:[(0,o.jsx)("summary",{children:"Download the Ralph Loop Recipes"}),(0,o.jsx)(n.p,{children:"Copy and paste this in your terminal to download the Ralph Loop recipes:"}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"mkdir -p ~/.config/goose/recipes\n\ncurl -sL https://raw.githubusercontent.com/block/goose/main/documentation/src/pages/recipes/data/recipes/ralph-loop.sh -o ~/.config/goose/recipes/ralph-loop.sh\ncurl -sL https://raw.githubusercontent.com/block/goose/main/documentation/src/pages/recipes/data/recipes/ralph-work.yaml -o ~/.config/goose/recipes/ralph-work.yaml\ncurl -sL https://raw.githubusercontent.com/block/goose/main/documentation/src/pages/recipes/data/recipes/ralph-review.yaml -o ~/.config/goose/recipes/ralph-review.yaml\n\nchmod +x ~/.config/goose/recipes/ralph-loop.sh\n"})})]}),"\n",(0,o.jsx)(n.admonition,{title:"Cost Warning",type:"warning",children:(0,o.jsxs)(n.p,{children:["Ralph Loop runs your agent multiple times in a loop (up to 10 iterations by default). Monitor your usage and adjust ",(0,o.jsx)(n.code,{children:"RALPH_MAX_ITERATIONS"})," if needed."]})}),"\n",(0,o.jsx)(n.h3,{id:"step-1-start-the-loop",children:"Step 1: Start the Loop"}),"\n",(0,o.jsx)(n.p,{children:"To start the process, run the script from your terminal and provide your prompt in quotes. This command triggers the first iteration of the worker and reviewer cycle:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'~/.config/goose/recipes/ralph-loop.sh "Create a simple browser using Electron and React"\n'})}),"\n",(0,o.jsxs)(n.admonition,{title:"For Complex Tasks",type:"tip",children:[(0,o.jsx)(n.p,{children:"You can pass a file path instead of a string. This works well for PRDs, detailed specs, or any multi-step task that benefits from iterative development:"}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"~/.config/goose/recipes/ralph-loop.sh ./prd.md\n"})})]}),"\n",(0,o.jsx)(n.h3,{id:"step-2-configure-models",children:"Step 2: Configure Models"}),"\n",(0,o.jsx)(n.p,{children:"The script will ask you to set your environment variables for the session:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"Worker model [gpt-4o]: \nWorker provider [openai]: \nReviewer model (should be different from worker): claude-sonnet-4-20250514\nReviewer provider: anthropic\nMax iterations [10]: \n\n\u26a0\ufe0f  Cost Warning: This will run up to 10 iterations, each using both models.\n    Estimated token usage could be significant depending on your task.\n\nContinue? [y/N]: y\n"})}),"\n",(0,o.jsxs)(n.table,{children:[(0,o.jsx)(n.thead,{children:(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.th,{children:"Variable"}),(0,o.jsx)(n.th,{children:"Description"})]})}),(0,o.jsxs)(n.tbody,{children:[(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"Worker model"}),(0,o.jsxs)(n.td,{children:["The model that does the actual coding work. Defaults to ",(0,o.jsx)(n.code,{children:"GOOSE_MODEL"})," if set."]})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"Worker provider"}),(0,o.jsxs)(n.td,{children:["The provider for the worker model (e.g., ",(0,o.jsx)(n.code,{children:"openai"}),", ",(0,o.jsx)(n.code,{children:"anthropic"}),"). Defaults to ",(0,o.jsx)(n.code,{children:"GOOSE_PROVIDER"})," if set."]})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"Reviewer model"}),(0,o.jsx)(n.td,{children:"The model that reviews the work. Should be different from the worker for best results."})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"Reviewer provider"}),(0,o.jsx)(n.td,{children:"The provider for the reviewer model."})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:"Max iterations"}),(0,o.jsx)(n.td,{children:"How many work/review cycles before giving up. Defaults to 10."})]})]})]}),"\n",(0,o.jsxs)(n.admonition,{title:"Directly Set Environment Variables",type:"tip",children:[(0,o.jsx)(n.p,{children:"You can skip the interactive prompts by setting environment variables directly"}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'RALPH_WORKER_MODEL="gpt-4o" \\\nRALPH_WORKER_PROVIDER="openai" \\\nRALPH_REVIEWER_MODEL="claude-sonnet-4-20250514" \\\nRALPH_REVIEWER_PROVIDER="anthropic" \\\n~/.config/goose/recipes/ralph-loop.sh "Create a simple browser using Electron and React"\n'})})]}),"\n",(0,o.jsx)(n.h3,{id:"step-3-watch-it-run",children:"Step 3: Watch It Run"}),"\n",(0,o.jsx)(n.p,{children:"The terminal will show goose moving through the worker and reviewer phases. Each iteration starts with a fresh session to keep the context clean. Here's what a successful run looks like:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  Ralph Loop - Multi-Model Edition\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n\n  Task: Create a simple browser using Electron and React\n  Worker: gpt-4o (openai)\n  Reviewer: claude-sonnet-4-20250514 (anthropic)\n  Max Iterations: 10\n\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  Iteration 1 / 10\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\u25b6 WORK PHASE\n... (goose creates initial implementation) ...\n\n\u25b6 REVIEW PHASE\n... (goose reviews the work) ...\n\n\u21bb REVISE - Feedback for next iteration:\nMissing error handling for invalid URLs. Also needs back/forward navigation buttons.\n\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n  Iteration 2 / 10\n\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\n\n\u25b6 WORK PHASE\n... (goose addresses feedback) ...\n\n\u25b6 REVIEW PHASE\n... (goose reviews again) ...\n\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n  \u2713 SHIPPED after 2 iteration(s)\n\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\n"})}),"\n",(0,o.jsx)(n.h2,{id:"how-it-works",children:"How It Works"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{children:"Iteration 1:\n  WORK PHASE  \u2192 Model A does work, writes to files\n  REVIEW PHASE \u2192 Model B reviews the work\n    \u2192 SHIP? Exit successfully \u2713\n    \u2192 REVISE? Write feedback, continue to iteration 2\n\nIteration 2:\n  WORK PHASE  \u2192 Model A reads feedback, fixes things (fresh context!)\n  REVIEW PHASE \u2192 Model B reviews again\n    \u2192 SHIP? Exit successfully \u2713\n    \u2192 REVISE? Continue...\n\n... repeats until SHIP or max iterations\n"})}),"\n",(0,o.jsx)(n.h3,{id:"state-files",children:"State Files"}),"\n",(0,o.jsxs)(n.p,{children:["Ralph Loop uses files in ",(0,o.jsx)(n.code,{children:".goose/ralph/"})," to persist state between iterations. This is how the worker knows what to do and the reviewer knows what was done, even though each iteration starts with fresh context."]}),"\n",(0,o.jsxs)(n.table,{children:[(0,o.jsx)(n.thead,{children:(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.th,{children:"File"}),(0,o.jsx)(n.th,{children:"Purpose"})]})}),(0,o.jsxs)(n.tbody,{children:[(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"task.md"})}),(0,o.jsx)(n.td,{children:"The task description"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"iteration.txt"})}),(0,o.jsx)(n.td,{children:"Current iteration number"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"work-summary.txt"})}),(0,o.jsx)(n.td,{children:"What the worker did this iteration"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"work-complete.txt"})}),(0,o.jsx)(n.td,{children:"Exists when worker claims done"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"review-result.txt"})}),(0,o.jsxs)(n.td,{children:[(0,o.jsx)(n.code,{children:"SHIP"})," or ",(0,o.jsx)(n.code,{children:"REVISE"})]})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"review-feedback.txt"})}),(0,o.jsx)(n.td,{children:"Feedback for next iteration"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:".ralph-complete"})}),(0,o.jsx)(n.td,{children:"Created on successful completion"})]}),(0,o.jsxs)(n.tr,{children:[(0,o.jsx)(n.td,{children:(0,o.jsx)(n.code,{children:"RALPH-BLOCKED.md"})}),(0,o.jsx)(n.td,{children:"Created if worker is stuck"})]})]})]}),"\n",(0,o.jsx)(n.h3,{id:"recipe-files",children:"Recipe Files"}),"\n",(0,o.jsxs)(n.p,{children:["The Ralph Loop uses three files: a bash script that orchestrates the work/review cycle, a work recipe that tells the worker model how to make progress, and a review recipe that tells the reviewer model how to evaluate the work. Below are the contents of each file. You can ",(0,o.jsx)(n.a,{href:"#prerequisites",children:"download"})," them or copy directly from here."]}),"\n",(0,o.jsxs)(t,{children:[(0,o.jsxs)("summary",{children:["The Bash Wrapper (",(0,o.jsx)(n.code,{children:"ralph-loop.sh"}),")"]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:'#!/bin/bash\n#\n# Ralph Loop - Multi-Model Edition\n#\n# Fresh context per iteration + cross-model review\n# Based on Geoffrey Huntley\'s technique\n#\n# Usage: ./ralph-loop.sh "your task description here"\n#    or: ./ralph-loop.sh /path/to/task.md\n#\n# Environment variables:\n#   RALPH_WORKER_MODEL    - Model for work phase (prompts if not set)\n#   RALPH_WORKER_PROVIDER - Provider for work phase (prompts if not set)\n#   RALPH_REVIEWER_MODEL  - Model for review phase (prompts if not set)\n#   RALPH_REVIEWER_PROVIDER - Provider for review phase (prompts if not set)\n#   RALPH_MAX_ITERATIONS  - Max iterations (default: 10)\n#   RALPH_RECIPE_DIR      - Recipe directory (default: ~/.config/goose/recipes)\n#\n\nset -e\n\nINPUT="$1"\nRECIPE_DIR="${RALPH_RECIPE_DIR:-$HOME/.config/goose/recipes}"\n\nRED=\'\\033[0;31m\'\nGREEN=\'\\033[0;32m\'\nYELLOW=\'\\033[1;33m\'\nBLUE=\'\\033[0;34m\'\nNC=\'\\033[0m\'\n\nif [ -z "$INPUT" ]; then\n    echo -e "${RED}Error: No task provided${NC}"\n    echo "Usage: $0 \\"your task description\\""\n    echo "   or: $0 /path/to/task.md"\n    exit 1\nfi\n\n# Function to prompt for settings\nprompt_for_settings() {\n    local default_model="${GOOSE_MODEL:-}"\n    local default_provider="${GOOSE_PROVIDER:-}"\n    \n    # Worker model\n    if [ -n "$default_model" ]; then\n        echo -ne "${BLUE}Worker model${NC} [${default_model}]: "\n        read -r user_input\n        WORKER_MODEL="${user_input:-$default_model}"\n    else\n        echo -ne "${BLUE}Worker model${NC}: "\n        read -r WORKER_MODEL\n        if [ -z "$WORKER_MODEL" ]; then\n            echo -e "${RED}Error: Worker model is required${NC}"\n            exit 1\n        fi\n    fi\n    \n    # Worker provider\n    if [ -n "$default_provider" ]; then\n        echo -ne "${BLUE}Worker provider${NC} [${default_provider}]: "\n        read -r user_input\n        WORKER_PROVIDER="${user_input:-$default_provider}"\n    else\n        echo -ne "${BLUE}Worker provider${NC}: "\n        read -r WORKER_PROVIDER\n        if [ -z "$WORKER_PROVIDER" ]; then\n            echo -e "${RED}Error: Worker provider is required${NC}"\n            exit 1\n        fi\n    fi\n    \n    # Reviewer model\n    echo -ne "${BLUE}Reviewer model${NC} (should be different from worker): "\n    read -r REVIEWER_MODEL\n    if [ -z "$REVIEWER_MODEL" ]; then\n        echo -e "${RED}Error: Reviewer model is required${NC}"\n        echo "The reviewer should be a different model to provide fresh perspective."\n        exit 1\n    fi\n    \n    # Reviewer provider\n    echo -ne "${BLUE}Reviewer provider${NC}: "\n    read -r REVIEWER_PROVIDER\n    if [ -z "$REVIEWER_PROVIDER" ]; then\n        echo -e "${RED}Error: Reviewer provider is required${NC}"\n        exit 1\n    fi\n    \n    # Same model warning\n    if [ "$WORKER_MODEL" = "$REVIEWER_MODEL" ] && [ "$WORKER_PROVIDER" = "$REVIEWER_PROVIDER" ]; then\n        echo -e "${YELLOW}Warning: Worker and reviewer are the same model.${NC}"\n        echo "For best results, use different models for cross-model review."\n        echo -ne "Continue anyway? [y/N]: "\n        read -r confirm\n        if [ "$confirm" != "y" ] && [ "$confirm" != "Y" ]; then\n            exit 1\n        fi\n    fi\n    \n    # Max iterations\n    echo -ne "${BLUE}Max iterations${NC} [10]: "\n    read -r user_input\n    MAX_ITERATIONS="${user_input:-10}"\n}\n\n# Initialize from environment variables\nWORKER_MODEL="${RALPH_WORKER_MODEL:-}"\nWORKER_PROVIDER="${RALPH_WORKER_PROVIDER:-}"\nREVIEWER_MODEL="${RALPH_REVIEWER_MODEL:-}"\nREVIEWER_PROVIDER="${RALPH_REVIEWER_PROVIDER:-}"\nMAX_ITERATIONS="${RALPH_MAX_ITERATIONS:-10}"\n\n# If any required setting is missing, prompt for all settings\nif [ -z "$WORKER_MODEL" ] || [ -z "$WORKER_PROVIDER" ] || [ -z "$REVIEWER_MODEL" ] || [ -z "$REVIEWER_PROVIDER" ]; then\n    prompt_for_settings\nfi\n\n# Cost warning and confirmation loop\nwhile true; do\n    echo ""\n    echo -e "${YELLOW}\u26a0\ufe0f  Cost Warning:${NC} This will run up to ${MAX_ITERATIONS} iterations, each using both models."\n    echo "    Estimated token usage could be significant depending on your task."\n    echo ""\n    echo -ne "Continue? [y/N]: "\n    read -r confirm\n    \n    if [ "$confirm" = "y" ] || [ "$confirm" = "Y" ]; then\n        break\n    else\n        echo ""\n        prompt_for_settings\n    fi\ndone\n\nSTATE_DIR=".goose/ralph"\nmkdir -p "$STATE_DIR"\n\nif [ -f "$INPUT" ]; then\n    cp "$INPUT" "$STATE_DIR/task.md"\n    echo -e "${BLUE}Reading task from file: $INPUT${NC}"\nelse\n    echo "$INPUT" > "$STATE_DIR/task.md"\nfi\n\nTASK=$(cat "$STATE_DIR/task.md")\n\nrm -f "$STATE_DIR/review-result.txt"\nrm -f "$STATE_DIR/review-feedback.txt"\nrm -f "$STATE_DIR/work-complete.txt"\nrm -f "$STATE_DIR/work-summary.txt"\n\necho -e "${BLUE}\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550${NC}"\necho -e "${BLUE}  Ralph Loop - Multi-Model Edition${NC}"\necho -e "${BLUE}\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550${NC}"\necho ""\necho -e "  Task: ${YELLOW}$TASK${NC}"\necho -e "  Worker: ${WORKER_MODEL} (${WORKER_PROVIDER})"\necho -e "  Reviewer: ${REVIEWER_MODEL} (${REVIEWER_PROVIDER})"\necho -e "  Max Iterations: $MAX_ITERATIONS"\necho ""\n\nfor i in $(seq 1 "$MAX_ITERATIONS"); do\n    echo -e "${BLUE}\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500${NC}"\n    echo -e "${BLUE}  Iteration $i / $MAX_ITERATIONS${NC}"\n    echo -e "${BLUE}\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500${NC}"\n    \n    echo "$i" > "$STATE_DIR/iteration.txt"\n    \n    echo ""\n    echo -e "${YELLOW}\u25b6 WORK PHASE${NC}"\n    \n    GOOSE_PROVIDER="$WORKER_PROVIDER" GOOSE_MODEL="$WORKER_MODEL" goose run --recipe "$RECIPE_DIR/ralph-work.yaml" || {\n        echo -e "${RED}\u2717 WORK PHASE FAILED${NC}"\n        exit 1\n    }\n    \n    if [ -f "$STATE_DIR/RALPH-BLOCKED.md" ]; then\n        echo ""\n        echo -e "${RED}\u2717 BLOCKED${NC}"\n        cat "$STATE_DIR/RALPH-BLOCKED.md"\n        exit 1\n    fi\n    \n    echo ""\n    echo -e "${YELLOW}\u25b6 REVIEW PHASE${NC}"\n    \n    GOOSE_PROVIDER="$REVIEWER_PROVIDER" GOOSE_MODEL="$REVIEWER_MODEL" goose run --recipe "$RECIPE_DIR/ralph-review.yaml" || {\n        echo -e "${RED}\u2717 REVIEW PHASE FAILED${NC}"\n        exit 1\n    }\n    \n    if [ -f "$STATE_DIR/review-result.txt" ]; then\n        RESULT=$(cat "$STATE_DIR/review-result.txt" | tr -d \'[:space:]\')\n        \n        if [ "$RESULT" = "SHIP" ]; then\n            echo ""\n            echo -e "${GREEN}\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550${NC}"\n            echo -e "${GREEN}  \u2713 SHIPPED after $i iteration(s)${NC}"\n            echo -e "${GREEN}\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550\u2550${NC}"\n            echo "COMPLETE: $(date)" > "$STATE_DIR/.ralph-complete"\n            exit 0\n        else\n            echo ""\n            echo -e "${YELLOW}\u21bb REVISE - Feedback for next iteration:${NC}"\n            if [ -f "$STATE_DIR/review-feedback.txt" ]; then\n                cat "$STATE_DIR/review-feedback.txt"\n            fi\n        fi\n    else\n        echo -e "${RED}\u2717 No review result found${NC}"\n        exit 1\n    fi\n    \n    rm -f "$STATE_DIR/work-complete.txt"\n    rm -f "$STATE_DIR/review-result.txt"\n    echo ""\ndone\n\necho -e "${RED}\u2717 Max iterations ($MAX_ITERATIONS) reached${NC}"\nexit 1\n'})})]}),"\n",(0,o.jsxs)(t,{children:[(0,o.jsxs)("summary",{children:["Work Phase Recipe (",(0,o.jsx)(n.code,{children:"ralph-work.yaml"}),")"]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'version: 1.0.0\ntitle: Ralph Work Phase\ndescription: Single iteration of work - fresh context each time\n\ninstructions: |\n  You are in a RALPH LOOP - one iteration of work.\n  \n  Your work persists through FILES ONLY. You will NOT remember previous iterations.\n  \n  STATE FILES (in .goose/ralph/):\n  - task.md = The task you need to accomplish (READ THIS FIRST)\n  - iteration.txt = Current iteration number\n  - review-feedback.txt = Feedback from last review (if any)\n  - work-complete.txt = Create when task is DONE (reviewer will verify)\n  \n  FIRST: Check your state\n  1. cat .goose/ralph/task.md (YOUR TASK)\n  2. cat .goose/ralph/iteration.txt 2>/dev/null || echo "1"\n  3. cat .goose/ralph/review-feedback.txt 2>/dev/null\n  4. ls -la to see existing work\n  \n  THEN: Make progress\n  - If review-feedback.txt exists, ADDRESS THAT FEEDBACK FIRST\n  - Read existing code/files before modifying\n  - Make meaningful incremental progress\n  - Run tests/verification if applicable\n  \n  FINALLY: Signal status\n  - If task is complete: echo "done" > .goose/ralph/work-complete.txt\n  - Always write a summary: echo "what I did" > .goose/ralph/work-summary.txt\n\nprompt: |\n  ## Ralph Work Phase\n  \n  Read your task from: .goose/ralph/task.md\n  \n  1. Read the task: `cat .goose/ralph/task.md`\n  2. Check iteration: `cat .goose/ralph/iteration.txt 2>/dev/null || echo "1"`\n  3. Check for review feedback: `cat .goose/ralph/review-feedback.txt 2>/dev/null`\n  4. List existing files: `ls -la`\n  5. Do the work (address feedback if any, otherwise make progress)\n  6. Write summary: `echo "summary" > .goose/ralph/work-summary.txt`\n  7. If complete: `echo "done" > .goose/ralph/work-complete.txt`\n\nextensions:\n  - type: builtin\n    name: developer\n    timeout: 600\n'})})]}),"\n",(0,o.jsxs)(t,{children:[(0,o.jsxs)("summary",{children:["Review Phase Recipe (",(0,o.jsx)(n.code,{children:"ralph-review.yaml"}),")"]}),(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-yaml",children:'version: 1.0.0\ntitle: Ralph Review Phase\ndescription: Cross-model review of work - returns SHIP or REVISE\n\ninstructions: |\n  You are a CODE REVIEWER in a Ralph Loop.\n  \n  Your job: Review the work done and decide SHIP or REVISE.\n  \n  You are a DIFFERENT MODEL than the worker. Your fresh perspective catches mistakes.\n  \n  STATE FILES (in .goose/ralph/):\n  - task.md = The original task (READ THIS FIRST)\n  - work-summary.txt = What the worker claims to have done\n  - work-complete.txt = Exists if worker claims task is complete\n  \n  REVIEW CRITERIA:\n  1. Does the code/work actually accomplish the task?\n  2. Does it run without errors?\n  3. Is it reasonably complete, not half-done?\n  4. Are there obvious bugs or issues?\n  \n  BE STRICT but FAIR:\n  - Don\'t nitpick style if functionality is correct\n  - DO reject incomplete work\n  - DO reject code that doesn\'t run\n  - DO reject if tests fail\n  \n  OUTPUT:\n  If approved: echo "SHIP" > .goose/ralph/review-result.txt\n  If needs work: \n    echo "REVISE" > .goose/ralph/review-result.txt\n    echo "specific feedback" > .goose/ralph/review-feedback.txt\n\nprompt: |\n  ## Ralph Review Phase\n  \n  1. Read the task: `cat .goose/ralph/task.md`\n  2. Read work summary: `cat .goose/ralph/work-summary.txt`\n  3. Check if complete: `cat .goose/ralph/work-complete.txt 2>/dev/null`\n  4. Examine the actual files created/modified\n  5. Run verification (tests, build, etc.)\n  6. Decide: SHIP or REVISE\n  \n  If SHIP: `echo "SHIP" > .goose/ralph/review-result.txt`\n  If REVISE: \n    `echo "REVISE" > .goose/ralph/review-result.txt`\n    `echo "specific feedback" > .goose/ralph/review-feedback.txt`\n\nextensions:\n  - type: builtin\n    name: developer\n    timeout: 300\n'})})]}),"\n",(0,o.jsx)(n.h2,{id:"usage-tips",children:"Usage Tips"}),"\n",(0,o.jsx)(n.h3,{id:"when-to-use-ralph-loop",children:"When to Use Ralph Loop"}),"\n",(0,o.jsx)(n.p,{children:"Ralph Loop works best for:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Complex, multi-step tasks"})," that benefit from iteration"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Tasks with clear completion criteria"})," (tests pass, builds succeed)"]}),"\n",(0,o.jsxs)(n.li,{children:[(0,o.jsx)(n.strong,{children:"Situations where you want quality gates"})," before shipping"]}),"\n"]}),"\n",(0,o.jsx)(n.p,{children:"It's overkill for:"}),"\n",(0,o.jsxs)(n.ul,{children:["\n",(0,o.jsx)(n.li,{children:"Simple one-shot tasks"}),"\n",(0,o.jsx)(n.li,{children:"Interactive/exploratory work"}),"\n",(0,o.jsx)(n.li,{children:"Tasks without verifiable completion criteria"}),"\n"]}),"\n",(0,o.jsx)(n.h3,{id:"resetting",children:"Resetting"}),"\n",(0,o.jsx)(n.p,{children:"If you want to start a completely new task, or if a previous run got stuck and you want to start over, you can clear the state directory:"}),"\n",(0,o.jsx)(n.pre,{children:(0,o.jsx)(n.code,{className:"language-bash",children:"rm -rf .goose/ralph\n"})})]})}function d(e={}){const{wrapper:n}={...(0,i.R)(),...e.components};return n?(0,o.jsx)(n,{...e,children:(0,o.jsx)(h,{...e})}):h(e)}},28453:(e,n,t)=>{t.d(n,{R:()=>s,x:()=>a});var r=t(96540);const o={},i=r.createContext(o);function s(e){const n=r.useContext(i);return r.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(o):e.components||o:s(e.components),r.createElement(i.Provider,{value:n},e.children)}}}]);